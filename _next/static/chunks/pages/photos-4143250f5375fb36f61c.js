_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[22],{"0CpR":function(e,t,o){e.exports={container:"photos_container__2ZDCf",container_bg:"photos_container_bg__2vUHm",container_radius:"photos_container_radius__1sSEA",page_title:"photos_page_title__w5Nuo",content:"photos_content__3JBP5",photo_container:"photos_photo_container__1DLuo",photo:"photos_photo__14wlp",editWrapper:"photos_editWrapper__3QJ0-"}},XXki:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/photos",function(){return o("gQxN")}])},gQxN:function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return T}));var a=o("q1tI"),r=o.n(a),s=o("rePB"),n=o("TSYQ"),c=o.n(n),i=o("T/mL"),l=o("B3wi"),p=o("pVHP"),h=(o("wx14"),o("Ff2n"),o("9rZX"),o("J3NM"),o("a/fa"),o("5bA4"),o("UESt"),o("VZWS"),o("5rEg")),d=o("uoqP");r.a.createElement;const{TextArea:u}=h.a;var m=o("0CpR"),b=o.n(m),f=o("jL+W"),_=o("NtVA"),g=o("Dlky"),v=o("tsqr"),w=o("2/Rp"),k=o("BvKs"),y=o("jsC+"),O=o("QMsE"),j=o("rOC1"),P=o("/MfK"),S=o("9mgU"),C=r.a.createElement;function E(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}var N=Object(f.a)((function({auth:e,authServices:t}){const{0:o,1:r}=Object(a.useContext)(_.a),{0:n,1:h}=Object(a.useState)(!1),u=null===o||void 0===o?void 0:o.photosData.filter(e=>"Photo"===e.type),m=async o=>{try{const o=await Object(d.b)({method:"post",url:"/accounts/photos",headers:{"x-token":e.token}}),{data:a,status:s}=o;200===s?r(Object(g.c)(a)):403===s?t.refreshToken(m):v.b.error((null===a||void 0===a?void 0:a.message)||"Something wrong")}catch(a){console.log(a)}},f=async a=>{try{const s=await Object(d.b)({method:"post",url:"/photos",data:a,headers:{"x-token":e.token}}),{data:n,status:c}=s;201===c?(h(0),r(Object(g.c)([...o.photosData,n]))):403===c?t.refreshToken(f):v.b.error((null===n||void 0===n?void 0:n.message)||"Something wrong")}catch(s){console.log(s)}},N=async(a,s,n)=>{var c="";"Photo"===a?c="/photos/react":"VideoClip"===a?c="/video-clips/react":"Item"===a?c="/items/react":"Post"===a?c="/posts/react":"Comment"===a?c="/comments/react":"Share"===a?c="/shares/react":"MarketplaceItemForSale"===a?c="/marketplace/items-for-sale/react":"MarketplaceItemToBuy"===a&&(c="/marketplace/items-to-buy/react");try{const a=await Object(d.b)({method:"post",url:c,data:{reacted:s,reaction:n},headers:{"x-token":e.token}}),{data:l,status:p}=a;if(201===p)var i=null===o||void 0===o?void 0:o.photosData.map((e,t)=>{if(e.id===s)return e.reactions[0].reaction,e;r(Object(g.c)(i))});else{if(403!=p)throw v.b.error((null===l||void 0===l?void 0:l.message)||"Something wrong"),new Error;t.refreshToken()}}catch(l){console.log(l)}},D=async(o,a)=>{var r="";"Photo"===o?r="/photos/share":"VideoClip"===o?r="/video-clips/share":"Item"===o?r="/items/share":"Post"===o?r="/posts/share":"Comment"===o?r="/comments/share":"Share"===o?r="/posts/share":"MarketplaceItemForSale"===o?r="/marketplace/items-for-sale/share":"MarketplaceItemToBuy"===o&&(r="/marketplace/items-to-buy/share");try{const o=await Object(d.b)({method:"post",url:r,data:{shared:a},headers:{"x-token":e.token}}),{data:s,status:n}=o;if(201===n)v.b.success("Shared successfully");else{if(403!=satus)throw v.b.error((null===s||void 0===s?void 0:s.message)||"Something wrong"),new Error;t.refreshToken()}}catch(s){console.log(s)}},T=t=>{var a=null===o||void 0===o?void 0:o.photosData.map(o=>{if(o.id==t.id){let a=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?E(Object(o),!0).forEach((function(t){Object(s.a)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):E(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({account:e.user},t.comments[0]);return"undefined"==typeof o.comments?o.comments=[a]:o.comments.push(a),o.commentsCount+=t.commentsCount,o}});r(Object(g.c)(a))};Object(a.useEffect)(()=>{m()},[]);const[x,M]=Object(i.b)(({in:t})=>C(_.b,null,C(p.a,{title:"Photo detail",showModal:t,onClose:M,data:u,profilePhoto:!0,likeAction:N,shareAction:D,onUpdateTimeline:T,auth:e})));return C("div",null,C(l.a,null),C("div",{className:c()(b.a.container,b.a.container_bg,b.a.container_radius)},C("div",{className:b.a.page_title},"Photos",C(w.a,{style:{float:"right",background:"transparent",color:"#0d7ac7"},onClick:()=>h(!0)},"Add Photos/Video")),C("div",{className:b.a.content},u.map(t=>{const a=C(k.a,null,C(k.a.Item,{onClick:()=>(async t=>{try{const a=await Object(d.b)({method:"delete",url:"/photos",data:{id:t},headers:{"x-token":e.token}}),{data:s,status:n}=a;if(204===n){const e=null===o||void 0===o?void 0:o.photosData.filter(e=>e.id!==t);r(Object(g.c)(e)),v.b.success("Deleted successfully!")}else 403===n?v.b.error("Please refresh page!"):v.b.error((null===s||void 0===s?void 0:s.message)||"Something wrong")}catch(a){console.log(a)}})(t.id)},C(P.a,{style:{fontSize:20}})," ",C("span",null,"Delete Photo")));return C("div",{className:b.a.photo_container,key:t.id},C("div",{className:b.a.photo},C("img",{src:"https://www.freeskies.com/static/".concat(t.blob_tn),alt:"",style:{width:"100%",height:"100%"},onClick:()=>x()}),C(y.a,{overlay:a,trigger:["click"]},C("div",{className:b.a.editWrapper},C(S.a,{style:{color:"white",position:"relative",display:"block",marginTop:4}})))))}))),C(j.a,{title:"Create Photos",showModal:n,onClose:()=>h(!1)},C(O.a,{onPosting:f})))})),D=r.a.createElement;function T(){return D("div",null,D(_.b,null,D(N,null)))}}},[["XXki",0,2,5,1,3,4,6,7,8,9,12]]]);
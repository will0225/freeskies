_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[24],{"8Bbg":function(e,t,n){e.exports=n("B5Ud")},B3wi:function(e,t,n){"use strict";var r=n("rePB"),a=n("q1tI"),o=n.n(a),c=n("Tyw5"),i=n.n(c),s=n("nOHt"),u=n("TSYQ"),l=n.n(u),d=n("LvDl"),p=n.n(d),m=n("/MKj"),f=n("ffwR"),h=o.a.createElement;function v(e){var t=e.user,n=void 0===t?{}:t,r=Object(s.useRouter)();return h("div",{className:i.a.profile,onClick:function(){r.push("/profile")}},h("div",{className:i.a.avatar},(null===n||void 0===n?void 0:n.profilePhoto)?h(f.a,{size:40,url:null===n||void 0===n?void 0:n.profilePhoto.src,text:null===n||void 0===n?void 0:n.username}):h(f.a,{size:40,text:null===n||void 0===n?void 0:n.firstName})),h("span",{className:i.a.name},"".concat(null===n||void 0===n?void 0:n.firstName)))}t.a=Object(m.b)((function(e){return{user:e.auth.user}}))((function(e){var t=e.withoutSearch,n=e.user,c=Object(a.useState)(0),s=c[0],u=(c[1],Object(a.useState)(!0)),d=u[0],m=u[1],f=null,g=function(){try{window.pageYOffset;f&&clearTimeout(f),f=setTimeout((function(){f=null,m(!0)}),500),d&&m(!1)}catch(e){console.log(e)}};return Object(a.useEffect)((function(){try{window.addEventListener("scroll",p.a.throttle(g,250))}catch(e){console.log(e)}return function(){try{window.removeEventListener("scroll",g)}catch(e){console.log(e)}}}),[s]),h(o.a.Fragment,null,h("div",{className:l()(i.a.header,Object(r.a)({},i.a.header_hidden,!d))},h("div",{className:i.a.container},h("div",{className:i.a.logo},h("img",{src:"/logo.png",alt:"logo"})),h("div",{className:i.a.search},!t&&h(o.a.Fragment,null,h("input",{name:"search",placeholder:"Search ..."}),h(v,null))),h(v,{user:n}))),h("div",{className:i.a.additional_header}))}))},B5Ud:function(e,t,n){"use strict";var r=n("o0o1"),a=n("lwsE"),o=n("W8MJ"),c=n("7W2i"),i=n("a1gu"),s=n("Nsbk"),u=n("yXPU");function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return i(this,n)}}var d=n("TqRt");t.__esModule=!0,t.Container=function(e){0;return e.children},t.createUrl=g,t.default=void 0;var p=d(n("q1tI")),m=n("g/15");function f(e){return h.apply(this,arguments)}function h(){return(h=u(r.mark((function e(t){var n,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Component,a=t.ctx,e.next=3,(0,m.loadGetInitialProps)(n,a);case 3:return o=e.sent,e.abrupt("return",{pageProps:o});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.AppInitialProps=m.AppInitialProps,t.NextWebVitalsMetric=m.NextWebVitalsMetric;var v=function(e){c(n,e);var t=l(n);function n(){return a(this,n),t.apply(this,arguments)}return o(n,[{key:"componentDidCatch",value:function(e,t){throw e}},{key:"render",value:function(){var e=this.props,t=e.router,n=e.Component,r=e.pageProps,a=e.__N_SSG,o=e.__N_SSP;return p.default.createElement(n,Object.assign({},r,a||o?{}:{url:g(t)}))}}]),n}(p.default.Component);function g(e){var t=e.pathname,n=e.asPath,r=e.query;return{get query(){return r},get pathname(){return t},get asPath(){return n},back:function(){e.back()},push:function(t,n){return e.push(t,n)},pushTo:function(t,n){var r=n?t:"",a=n||t;return e.push(r,a)},replace:function(t,n){return e.replace(t,n)},replaceTo:function(t,n){var r=n?t:"",a=n||t;return e.replace(r,a)}}}t.default=v,v.origGetInitialProps=f,v.getInitialProps=f},"Dx8+":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return G}));var r=n("q1tI"),a=n.n(r),o=n("KQm4"),c=n("rePB"),i=n("o0o1"),s=n.n(i),u=n("HaE+"),l=n("B3wi"),d=n("PObt"),p=n("A9a1"),m=n("qg42"),f=n.n(m),h=n("uoqP"),v=n("tsqr"),g=a.a.createElement;function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={loading:!1,postingLoading:!1,timelineData:[]};function w(e,t){var n=t.type,r=t.payload;switch(n){case"timeline/SET_LOADING":return O(O({},e),{},{loading:r});case"timeline/SET_POSTING_LOADING":return O(O({},e),{},{postingLoading:r});case"timeline/SET_TIMELINE_DATA":return O(O({},e),{},{timelineData:r});default:return e}}var j=Object(r.createContext)([{},function(){}]),P=function(e){var t=e.children,n=Object(r.useReducer)(w,y);return g(j.Provider,{value:n},t)};function N(e){switch(e){case"timeline":return"timeline/SET_LOADING";case"posting":return"timeline/SET_POSTING_LOADING";default:return""}}var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timeline";return{type:N(t),payload:e}},E=function(e){return{type:"timeline/SET_TIMELINE_DATA",payload:e}},k={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},S=n("6VBw"),D=function(e,t){return r.createElement(S.a,Object.assign({},e,{ref:t,icon:k}))};D.displayName="LoadingOutlined";var C=r.forwardRef(D),T=a.a.createElement;function I(e){var t=e.loading,n=e.children;return t?T("div",{style:{margin:"2em",textAlign:"center"}},T(C,{style:{fontSize:"2em",color:"#407cff"}})):n}var R=n("jL+W"),A=n("rOC1"),L=n("ffwR"),q=a.a.createElement;function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=Object(R.a)((function(e){var t,n,c=e.authServices,i=e.auth,m=Object(r.useContext)(j),g=m[0],b=m[1],O=Object(r.useState)(!1),y=O[0],w=O[1],P=Object(r.useState)(!1),N=P[0],k=P[1],S=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,o,i,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],e.prev=1,n||b(x(!0)),e.next=5,Object(h.a)({method:"post",url:"/accounts/timeline",headers:{"x-token":t}});case 5:r=e.sent,a=r.data,200===(o=r.status)?(i=a.map((function(e){return e=D(e)})),console.log(i),b(E(i)),console.log("=========")):403===o?(console.log("================= Refresh token !"),c.refreshToken(S)):v.b.error((null===a||void 0===a?void 0:a.message)||"Something wrong"),n||b(x(!1)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),n||b(x(!1));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),D=function(e){return"Comment"===e.type?"Post"==e.commented.type?M(M({},e.commented),{},{comments:[M(M({},e),{},{account:e.commented.account})]}):"Comment"==e.commented.type?M(M({},e.commented.commented),{},{comments:[M(M({},e.commented),{},{comments:[e],account:e.commented.commented.account})]}):"Share"==e.commented.type?M(M({},e.commented.shared),{},{comments:[M(M({},e),{},{account:e.commented.shared.account})]}):M(M({},e.commented),{},{comments:[M(M({},e),{},{account:e.commented.account})]}):"Post"===e.type?e:"Share"===e.type?M(M({},e.shared),{},{comments:[M(M({},e),{},{account:e.shared.account})]}):e},C=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(x(!0,"posting")),e.next=4,Object(h.a)({method:"post",url:"/posts",data:t,headers:{"x-token":i.token}});case 4:return n=e.sent,r=n.data,201===n.status?(w(0),a=M(M({type:"Post"},r),{},{comments:[],commentsCount:0,rating:null,reactions:[],reactionsCount:0,shares:[],sharesCount:0,account:i.user}),c=[a].concat(Object(o.a)(g.timelineData)),console.log(c),b(E(c))):v.b.error((null===r||void 0===r?void 0:r.message)||"Something wrong"),b(x(!1,"posting")),e.next=10,n;case 10:return e.abrupt("return",e.sent);case 13:e.prev=13,e.t0=e.catch(0),b(x(!1,"posting"));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(s.a.mark((function e(t,n,r){var a,o,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(x(!0,"posting")),a="","Photo"===t?a="/photos/rate":"VideoClip"===t?a="/video-clips/rate":"Item"===t?a="/items/rate":"Post"===t?a="/posts/rate":"Comment"===t&&(a="/comments/rate"),e.next=6,Object(h.a)({method:"post",url:a,data:{rated:n,rating:r},headers:{"x-token":i.token}});case 6:return o=e.sent,c=o.data,u=o.status,console.warn("ratePost",c,u),201===u?(g.timelineData.map((function(e){if(e.id===n&&e.type===t)return e.rating=r,e})),b(E(g.timelineData))):v.b.error((null===c||void 0===c?void 0:c.message)||"Something wrong"),b(x(!1,"posting")),e.next=13,o;case 13:return e.abrupt("return",e.sent);case 16:e.prev=16,e.t0=e.catch(0),b(x(!1,"posting"));case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n,r){return e.apply(this,arguments)}}(),R=function(){w(!0)},B=function(){var e=Object(u.a)(s.a.mark((function e(t,n,r){var a,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="","Photo"===t?a="/photos/react":"VideoClip"===t?a="/video-clips/react":"Item"===t?a="/items/react":"Post"===t?a="/posts/react":"Comment"===t?a="/comments/react":"Share"===t&&(a="/shares/react"),e.prev=2,e.next=5,Object(h.a)({method:"post",url:a,data:{reacted:n,reaction:r},headers:{"x-token":i.token}});case 5:if(o=e.sent,c=o.data,201!==o.status){e.next=11;break}v.b.success("Evaluate successfully"),e.next=13;break;case 11:throw v.b.error((null===c||void 0===c?void 0:c.message)||"Something wrong"),new Error;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n,r){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="","Photo"===t?r="/photos/share":"VideoClip"===t?r="/video-clips/share":"Item"===t?r="/items/share":"Post"===t?r="/posts/share":"Comment"===t?r="/comments/share":"Share"===t&&(r="/posts/share"),e.prev=2,e.next=5,Object(h.a)({method:"post",url:r,data:{shared:n},headers:{"x-token":i.token}});case 5:if(a=e.sent,o=a.data,201!==a.status){e.next=11;break}v.b.success("Evaluate successfully"),e.next=13;break;case 11:throw v.b.error((null===o||void 0===o?void 0:o.message)||"Something wrong"),new Error;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){S(i.token),window.addEventListener("scroll",_.throttle((function(){var e=window.pageYOffset;k(e>100)}),250))}),[]);var W=i.user;return q(a.a.Fragment,null,q(l.a,null),N?q("div",{className:f.a.mobile_profile_header},q("div",{className:f.a.avatar},q("div",{className:f.a.avatar_image},q(L.a,{size:40,url:null===W||void 0===W||null===(t=W.profilePhoto)||void 0===t?void 0:t.src,text:null===W||void 0===W?void 0:W.username}))),q("p",{className:f.a.mobile_fullname,style:{cursor:"pointer"}},q("span",null,"".concat(null===W||void 0===W?void 0:W.firstName," ").concat(null===W||void 0===W?void 0:W.lastName)))):null,q("div",{className:f.a.timeline},q("div",{className:f.a.feed_container},q("div",{className:f.a.createPostDiv},q(L.a,{size:50,url:null===W||void 0===W||null===(n=W.profilePhoto)||void 0===n?void 0:n.src}),q("input",{className:f.a.createPostInput,placeholder:"What's on your mind?",onClick:R})),q(I,{loading:g.loading},q(d.a,{data:g.timelineData,onUpdateTimeline:function(e){g.timelineData.map((function(t){if(t.id==e.id){var n=M({account:i.user},e.comments[0]);return t.comments.push(n),t.commentsCount+=e.commentsCount,t}})),console.log(g.timelineData),b(E(g.timelineData))},onRatePost:T,likeAction:B,shareAction:U})))),q(A.a,{title:"Create Post",showModal:y,onClose:function(){return w(0)}},q(p.a,{loading:g.postingLoading,onPosting:C,modalPopup:R})))})),W=a.a.createElement;function G(){return W("div",null,W(P,null,W(U,null)))}},Tyw5:function(e,t,n){e.exports={additional_header:"header_additional_header__Wyu42",header:"header_header__ecC39",header_hidden:"header_header_hidden__2Q2DD",container:"header_container__bXWQQ",logo:"header_logo__2MPw_",search:"header_search__sw4Be",profile:"header_profile__1JSwu",name:"header_name__3HhTm",avatar:"header_avatar__boSZH"}},"jL+W":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("wx14"),a=n("Ff2n"),o=n("1OyB"),c=n("vuIU"),i=n("JX7q"),s=n("Ji7U"),u=n("md7G"),l=n("foSv"),d=n("rePB"),p=n("q1tI"),m=n.n(p),f=n("8Bbg"),h=n.n(f),v=n("/MKj"),g=n("nOHt"),b=n.n(g),O=m.a.createElement;function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}function y(e){var t=function(t){Object(s.a)(u,t);var n=_(u);function u(){var e;Object(o.a)(this,u);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=n.call.apply(n,[this].concat(r)),Object(d.a)(Object(i.a)(e),"UNSAFE_componentWillMount",(function(){e.checkAuth(e.props),e.getUserData(),console.log("Test")})),Object(d.a)(Object(i.a)(e),"UNSAFE_componentWillReceiveProps",(function(t){e.checkAuth(t)})),Object(d.a)(Object(i.a)(e),"checkAuth",(function(e){var t=e.authenticated;e.authenticating||t||(console.log("redirect"),b.a.replace("/login?r=".concat(redir.pathname+encodeURIComponent(redir.search)),"/login",{shallow:!0}))})),Object(d.a)(Object(i.a)(e),"getUserData",(function(){(0,e.props.dispatch)({type:"@@auth/GET_USER"})})),Object(d.a)(Object(i.a)(e),"refreshToken",(function(){(0,e.props.dispatch)({type:"@@auth/REFRESH_TOKEN"})})),e}return Object(c.a)(u,[{key:"render",value:function(){var t=this.props,n=t.authenticating,o=(t.authenticated,t.auth),c=Object(a.a)(t,["authenticating","authenticated","auth"]);return n?O("div",{className:"loading-container"},O("div",{className:"border border-gray-300 shadow rounded-md p-4 max-w-sm w-full mx-auto"},O("div",{className:"animate-pulse flex space-x-4"},O("div",{className:"rounded-full bg-gray-400 h-12 w-12"}),O("div",{className:"flex-1 space-y-4 py-1"},O("div",{className:"h-4 bg-gray-400 rounded w-3/4"}),O("div",{className:"space-y-2"},O("div",{className:"h-4 bg-gray-400 rounded"}),O("div",{className:"h-4 bg-gray-400 rounded w-5/6"})))))):O(e,Object(r.a)({},c,{auth:o}))}}]),u}(h.a);return Object(v.b)((function(e){return{authenticating:e.auth.authenticating,auth:e.auth,authenticated:e.auth.authenticated}}))(t)}},mDtT:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/timeline",function(){return n("Dx8+")}])},qg42:function(e,t,n){e.exports={timeline:"timeline_timeline__mY-nJ",createPostInput:"timeline_createPostInput__Xrg8W",createPostDiv:"timeline_createPostDiv__1JJhj",mobile_profile_header:"timeline_mobile_profile_header__TFfnT"}},rOC1:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("rePB"),a=n("Ff2n"),o=n("q1tI"),c=n.n(o),i=n("9rZX"),s=n.n(i),u=n("4i/N"),l=n("a/fa"),d=n.n(l),p=n("TSYQ"),m=n.n(p),f=c.a.createElement;s.a.setAppElement("#modal_place");var h={content:{},overlay:{backgroundColor:"rgba(50, 50, 50, .8)"}};function v(e){var t=e.children,n=e.showModal,o=e.narrow_container,c=e.title,i=Object(a.a)(e,["children","showModal","narrow_container","title"]);return f(s.a,{isOpen:n,style:h,className:m()(d.a.modal_content,Object(r.a)({},d.a.narrow,o)),shouldCloseOnOverlayClick:!0,onRequestClose:i.onClose},f("div",{className:d.a.header},f("div",{className:d.a.title},f("p",{style:{color:"white"}},c)),f("button",{className:d.a.close,type:"button",onClick:i.onClose},f(u.a,null))),f("div",{className:d.a.content},t))}}},[["mDtT",0,2,5,10,1,3,4,6,8,7,9]]]);
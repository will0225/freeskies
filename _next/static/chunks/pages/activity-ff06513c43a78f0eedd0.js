_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"07EC":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return A}));var o=a("q1tI"),n=a.n(o),r=a("rePB"),s=a("B3wi"),c=(a("Bfm4"),a("A9a1")),i=a("5D7U"),l=a.n(i),d=a("rOC1"),u=a("ffwR"),m=a("uoqP"),p=a("tsqr"),_=a("jL+W"),h=n.a.createElement;function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const g={loading:!1,postingLoading:!1,activityData:[]};function y(e,{type:t,payload:a}){switch(t){case"activity/SET_LOADING":return f(f({},e),{},{loading:a});case"activity/SET_POSTING_LOADING":return f(f({},e),{},{postingLoading:a});case"activity/SET_ACTIVITY_DATA":return f(f({},e),{},{activityData:a});default:return e}}const b=Object(o.createContext)([{},()=>{}]),O=({children:e})=>{const t=Object(o.useReducer)(y,g);return h(b.Provider,{value:t},e)};function w(e){switch(e){case"activity":return"activity/SET_LOADING";case"posting":return"activity/SET_POSTING_LOADING";default:return""}}var P=(e,t="activity")=>({type:w(t),payload:e});var j=e=>({type:"activity/SET_ACTIVITY_DATA",payload:e}),N=a("PObt"),C=a("FVaq"),E=n.a.createElement;function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=Object(_.a)((function({authServices:e,auth:t}){var a,r;const{0:i,1:_}=Object(o.useContext)(b),{0:h,1:v}=Object(o.useState)(!1),{0:f,1:g}=Object(o.useState)(!1),y=async t=>{try{const o=await Object(m.a)({method:"post",url:"/accounts/activity",headers:{"x-token":t}}),{data:n,status:r}=o;if(200===r){var a=n.map(e=>e=O(e));_(j(a))}else 403===r?e.refreshToken(y):p.b.error((null===n||void 0===n?void 0:n.message)||"Something wrong")}catch(o){console.log(o)}},O=e=>"Comment"===e.type?"Post"==e.commented.type?D(D({},e.commented),{},{comments:[D(D({},e),{},{account:e.commented.account})]}):"Comment"==e.commented.type?D(D({},e.commented.commented),{},{comments:[D(D({},e.commented),{},{comments:[e],account:e.commented.commented.account})]}):"Share"==e.commented.type?D(D({},e.commented.shared),{},{comments:[D(D({},e),{},{account:e.commented.shared.account})]}):D(D({},e.commented),{},{comments:[D(D({},e),{},{account:e.commented.account})]}):"Post"===e.type?e:"Share"===e.type?D(D({},e.shared),{},{comments:[D(D({},e),{},{account:e.shared.account})]}):e,w=()=>{v(!0)};Object(o.useEffect)(()=>{y(t.token)},[]);const{user:S}=t;return E(n.a.Fragment,null,E(s.a,null),f?E("div",{className:l.a.mobile_profile_header},E("div",{className:l.a.avatar},E("div",{className:l.a.avatar_image},E(u.a,{size:40,url:null===S||void 0===S||null===(a=S.profilePhoto)||void 0===a?void 0:a.src,text:null===S||void 0===S?void 0:S.username}))),E("p",{className:l.a.mobile_fullname,style:{cursor:"pointer"}},E("span",null,"".concat(null===S||void 0===S?void 0:S.firstName," ").concat(null===S||void 0===S?void 0:S.lastName)))):null,E("div",{className:l.a.feed},E("div",{className:l.a.feed_container},E("div",{className:l.a.createPostDiv},E(u.a,{size:50,url:null===S||void 0===S||null===(r=S.profilePhoto)||void 0===r?void 0:r.src}),E("input",{className:l.a.createPostInput,placeholder:"What's on your mind?",onClick:w})),E(C.a,{loading:i.loading},E(N.a,{data:i.activityData,onUpdateTimeline:e=>{i.activityData.map(a=>{if(a.id==e.id){let o=D({account:t.user},e.comments[0]);return a.comments.push(o),a.commentsCount+=e.commentsCount,a}}),console.log(i.activityData),_(j(i.activityData))},onRatePost:async(e,a,o)=>{try{_(P(!0,"posting"));let n="";"Photo"===e?n="/photos/rate":"VideoClip"===e?n="/video-clips/rate":"Item"===e?n="/items/rate":"Post"===e?n="/posts/rate":"Comment"===e&&(n="/comments/rate");const r=await Object(m.a)({method:"post",url:n,data:{rated:a,rating:o},headers:{"x-token":t.token}}),{data:s,status:c}=r;return console.warn("ratePost",s,c),201===c?(i.activityData.map(t=>{if(t.id===a&&t.type===e)return t.rating=o,t}),_(j(i.activityData))):p.b.error((null===s||void 0===s?void 0:s.message)||"Something wrong"),_(P(!1,"posting")),await r}catch(n){_(P(!1,"posting"))}},likeAction:async(e,a,o)=>{var n="";"Photo"===e?n="/photos/react":"VideoClip"===e?n="/video-clips/react":"Item"===e?n="/items/react":"Post"===e?n="/posts/react":"Comment"===e?n="/comments/react":"Share"===e&&(n="/shares/react");try{const e=await Object(m.a)({method:"post",url:n,data:{reacted:a,reaction:o},headers:{"x-token":t.token}}),{data:r,status:s}=e;if(201!==s)throw p.b.error((null===r||void 0===r?void 0:r.message)||"Something wrong"),new Error;p.b.success("Evaluate successfully")}catch(r){console.log(r)}},shareAction:async(e,a)=>{var o="";"Photo"===e?o="/photos/share":"VideoClip"===e?o="/video-clips/share":"Item"===e?o="/items/share":"Post"===e?o="/posts/share":"Comment"===e?o="/comments/share":"Share"===e&&(o="/posts/share");try{const e=await Object(m.a)({method:"post",url:o,data:{shared:a},headers:{"x-token":t.token}}),{data:n,status:r}=e;if(201!==r)throw p.b.error((null===n||void 0===n?void 0:n.message)||"Something wrong"),new Error;p.b.success("Evaluate successfully")}catch(n){console.log(n)}}})))),E(d.a,{title:"Create Post",showModal:h,onClose:()=>v(0)},E(c.a,{loading:i.postingLoading,onPosting:async e=>{try{_(P(!0,"posting"));const a=await Object(m.a)({method:"post",url:"/posts",data:e,headers:{"x-token":t.token}}),{data:o,status:n}=a;if(201===n){v(0);let e=[D(D({type:"Post"},o),{},{comments:[],commentsCount:0,rating:null,reactions:[],reactionsCount:0,shares:[],sharesCount:0,account:t.user}),...i.activityData];console.log(e),_(j(e))}else p.b.error((null===o||void 0===o?void 0:o.message)||"Something wrong");return _(P(!1,"posting")),await a}catch(a){_(P(!1,"posting"))}},modalPopup:w})))})),T=n.a.createElement;function A(){return T("div",null,T(O,null,T(k,null)))}},"5D7U":function(e,t,a){e.exports={feed:"feed_feed__3HJC8",createPostInput:"feed_createPostInput__36HyW",createPostDiv:"feed_createPostDiv__3Zj4X",mobile_profile_header:"feed_mobile_profile_header__2aDWK"}},B3wi:function(e,t,a){"use strict";var o=a("q1tI"),n=a.n(o),r=a("Tyw5"),s=a.n(r),c=a("nOHt"),i=a("TSYQ"),l=a.n(i),d=a("LvDl"),u=a.n(d),m=a("/MKj"),p=a("ffwR"),_=n.a.createElement;function h({user:e={}}){const t=Object(c.useRouter)();return _("div",{className:s.a.profile,onClick:()=>{t.push("/profile")}},_("div",{className:s.a.avatar},(null===e||void 0===e?void 0:e.profilePhoto)?_(p.a,{size:40,url:null===e||void 0===e?void 0:e.profilePhoto.src,text:null===e||void 0===e?void 0:e.username}):_(p.a,{size:40,text:null===e||void 0===e?void 0:e.firstName})),_("span",{className:s.a.name},"".concat(null===e||void 0===e?void 0:e.firstName)))}t.a=Object(m.b)(e=>({user:e.auth.user}))((function({withoutSearch:e,user:t}){const{0:a,1:r}=Object(o.useState)(0),{0:c,1:i}=Object(o.useState)(!0);let d=null;const m=()=>{try{window.pageYOffset;d&&clearTimeout(d),d=setTimeout(()=>{d=null,i(!0)},500),c&&i(!1)}catch(e){console.log(e)}};return Object(o.useEffect)(()=>{try{window.addEventListener("scroll",u.a.throttle(m,250))}catch(e){console.log(e)}return()=>{try{window.removeEventListener("scroll",m)}catch(e){console.log(e)}}},[a]),_(n.a.Fragment,null,_("div",{className:l()(s.a.header,{[s.a.header_hidden]:!c})},_("div",{className:s.a.container},_("div",{className:s.a.logo},_("img",{src:"/logo.png",alt:"logo"})),_("div",{className:s.a.search},!e&&_(n.a.Fragment,null,_("input",{name:"search",placeholder:"Search Freeskies"}),_(h,null))),_(h,{user:t}))),_("div",{className:s.a.additional_header}),_("div",{className:l()(s.a.mobile_profile_header,{[s.a.header_hidden]:!c})},_("div",{className:s.a.container},_(h,{user:t}))),_("div",{className:l()(s.a.mobile_top_header,{[s.a.header_hidden]:!c})},_("div",{className:s.a.container},_("div",{className:s.a.logo},_("img",{src:"/logo.png",alt:"logo"})),_("div",{className:s.a.search},!e&&_(n.a.Fragment,null,_("input",{name:"search",placeholder:"Search Freeskies"}))))))}))},Bfm4:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var o=a("q1tI"),n=a.n(o),r=a("aZUF"),s=a.n(r),c=a("2/Rp"),i=(a("TSYQ"),a("nOHt")),l=(a("ffwR"),a("PObt")),d=n.a.createElement;function u({user:e,onRatePost:t,onUpdateTimeline:a,likeAction:o,shareAction:n,deleteAction:r}){var u;const m=Object(i.useRouter)(),p=(null!==e&&void 0!==e&&"https://freeskies.com/static/".concat(null===(u=e.profilePhoto)||void 0===u?void 0:u.src),null!==e&&void 0!==e?null===e||void 0===e?void 0:e.activity.map(t=>(t.account=e,t)):[]);return d("div",{className:s.a.activity_content},d("div",{className:s.a.section_title},d(c.a,{type:"link",onClick:()=>{m.push("/activity")}},"All activities")),0!==p.length&&d(l.a,{data:p,onRatePost:t,onUpdateTimeline:a,likeAction:o,shareAction:n,deleteAction:r}))}},FVaq:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var o=a("q1tI"),n=a.n(o),r={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},s=a("6VBw"),c=function(e,t){return o.createElement(s.a,Object.assign({},e,{ref:t,icon:r}))};c.displayName="LoadingOutlined";var i=o.forwardRef(c),l=n.a.createElement;function d(e){var t=e.loading,a=e.children;return t?l("div",{style:{margin:"2em",textAlign:"center"}},l(i,{style:{fontSize:"2em",color:"#407cff"}})):a}},Tyw5:function(e,t,a){e.exports={additional_header:"header_additional_header__Wyu42",header:"header_header__ecC39",header_hidden:"header_header_hidden__2Q2DD",container:"header_container__bXWQQ",logo:"header_logo__2MPw_",search:"header_search__sw4Be",profile:"header_profile__1JSwu",name:"header_name__3HhTm",avatar:"header_avatar__boSZH",mobile_profile_header:"header_mobile_profile_header__2TJiv",mobile_top_header:"header_mobile_top_header__3ihGH"}},aZUF:function(e,t,a){e.exports={activity_content:"feed-post_activity_content__3N-h7",section_title:"feed-post_section_title__1we2Z",post:"feed-post_post__bhijE",post_header:"feed-post_post_header__1Sj-6",avatar:"feed-post_avatar__O0xLc",user_info:"feed-post_user_info__29hGR",user_name:"feed-post_user_name__5k8XZ",date:"feed-post_date__2-Vtb",post_content:"feed-post_post_content__2oE53",description:"feed-post_description__10C5X",image:"feed-post_image__3H2wO",post_actions:"feed-post_post_actions__1-APA",posts:"feed-post_posts__3gKRn",comments:"feed-post_comments__2alYi"}},pAKN:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/activity",function(){return a("07EC")}])},rOC1:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var o=a("rePB"),n=a("Ff2n"),r=a("q1tI"),s=a.n(r),c=a("9rZX"),i=a.n(c),l=a("4i/N"),d=a("a/fa"),u=a.n(d),m=a("TSYQ"),p=a.n(m),_=s.a.createElement;i.a.setAppElement("#modal_place");var h={content:{},overlay:{backgroundColor:"rgba(50, 50, 50, .8)"}};function v(e){var t=e.children,a=e.showModal,r=e.narrow_container,s=e.title,c=Object(n.a)(e,["children","showModal","narrow_container","title"]);return _(i.a,{isOpen:a,style:h,className:p()(u.a.modal_content,Object(o.a)({},u.a.narrow,r)),shouldCloseOnOverlayClick:!0,onRequestClose:c.onClose},_("div",{className:u.a.header},_("div",{className:u.a.title},_("p",{style:{color:"white"}},s)),_("button",{className:u.a.close,type:"button",onClick:c.onClose},_(l.a,null))),_("div",{className:u.a.content},t))}}},[["pAKN",0,2,5,10,1,3,4,6,8,7,9,11]]]);